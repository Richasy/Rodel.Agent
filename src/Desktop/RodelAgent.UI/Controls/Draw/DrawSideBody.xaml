<?xml version="1.0" encoding="utf-8" ?>
<local:DrawPageControlBase
    x:Class="RodelAgent.UI.Controls.Draw.DrawSideBody"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ai="using:Richasy.WinUIKernel.AI"
    xmlns:base="using:Richasy.WinUIKernel.Share.Base"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:items="using:RodelAgent.UI.ViewModels.Items"
    xmlns:local="using:RodelAgent.UI.Controls.Draw"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid>
        <ScrollView
            Padding="16,0"
            Style="{StaticResource PageScrollViewStyle}"
            Visibility="{x:Bind ViewModel.IsHistoryEmpty, Mode=OneWay, Converter={StaticResource BoolToVisibilityReverseConverter}}">
            <Grid Margin="0,12,0,20">
                <ItemsRepeater ItemsSource="{x:Bind ViewModel.History}">
                    <ItemsRepeater.ItemTemplate>
                        <DataTemplate x:DataType="items:DrawRecordItemViewModel">
                            <base:CardControl>
                                <Grid Margin="16,12" RowSpacing="8">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <base:TrimTextBlock
                                        FontSize="12"
                                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                        MaxLines="3"
                                        Text="{x:Bind Data.Prompt}" />
                                    <local:DrawHistoryImage
                                        Grid.Row="1"
                                        MinHeight="20"
                                        CornerRadius="{StaticResource ControlCornerRadius}"
                                        DecodeHeight="{x:Bind Height}"
                                        DecodeWidth="{x:Bind Width}"
                                        Source="{x:Bind Image}" />
                                    <Grid Grid.Row="2" ColumnSpacing="8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <ai:AILogo
                                            Width="20"
                                            Height="20"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center"
                                            AvatarPadding="4"
                                            IsAvatar="True"
                                            Provider="{x:Bind Data.Provider}" />
                                        <TextBlock
                                            Grid.Column="1"
                                            VerticalAlignment="Center"
                                            Foreground="{ThemeResource TextFillColorTertiaryBrush}"
                                            Style="{StaticResource CaptionTextBlockStyle}"
                                            Text="{x:Bind Time}" />
                                    </Grid>
                                </Grid>
                            </base:CardControl>
                        </DataTemplate>
                    </ItemsRepeater.ItemTemplate>
                    <ItemsRepeater.Layout>
                        <StackLayout Spacing="8" />
                    </ItemsRepeater.Layout>
                </ItemsRepeater>
            </Grid>
        </ScrollView>
    </Grid>

</local:DrawPageControlBase>
